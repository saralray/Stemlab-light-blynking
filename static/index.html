<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Light Presets</title>

<!-- PWA / iOS -->
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Presets">
<meta name="theme-color" content="#0b0e1a">

<link rel="manifest" href="/manifest.json">

<!-- iOS icon -->
<link rel="apple-touch-icon" href="/icons/icon-180.png">


<style>
:root {
  --bg: #0b0e1a;
  --panel: #14182f;
  --btn: #1f2450;
  --glow: #6cf2c2;
  --text: #eef0ff;
  --muted: #9aa0c7;
}

* {
  box-sizing: border-box;
  font-family: system-ui, sans-serif;
}

body {
  margin: 0;
  height: 100vh;
  background: radial-gradient(circle at top, #1a1f40, var(--bg));
  color: var(--text);
  display: flex;
  align-items: center;
  justify-content: center;
  overscroll-behavior: none;
  touch-action: manipulation;
}

/* ===== PANEL ===== */
.panel {
  width: 75vw;
  height: 75vh;
  background: var(--panel);
  border-radius: 36px;
  padding: 48px;                /* MORE BREATHING ROOM */
  box-shadow: 0 40px 100px rgba(0,0,0,.6);
  display: flex;
  flex-direction: column;
}

/* ===== TITLE ===== */
h1 {
  margin: 0 0 36px;              /* MORE SPACE BELOW TITLE */
  text-align: center;
  font-size: clamp(1.8rem, 3vw, 2.6rem);
}

/* ===== GRID ===== */
.grid {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 32px;                     /* BIGGER GAPS */
  align-content: center;
}

/* ===== BUTTONS ===== */
button {
  position: relative;
  padding: 44px 24px;            /* FAT BUTTONS */
  border-radius: 26px;
  border: none;
  background: var(--btn);
  color: var(--text);
  font-size: clamp(1.2rem, 2vw, 1.6rem);
  font-weight: 600;
  cursor: pointer;
  transition: transform .15s ease, filter .15s ease;
}

button:hover {
  transform: translateY(-3px);
  filter: brightness(1.1);
}

/* ===== ACTIVE GLOW ===== */
button.active {
  animation: glowPulse 1.8s ease-in-out infinite;
}

button.active::after {
  content: "";
  position: absolute;
  inset: -12px;                  /* BIGGER GLOW RING */
  border-radius: 32px;
  box-shadow:
    0 0 26px var(--glow),
    0 0 70px rgba(108,242,194,.6);
  pointer-events: none;
}

@keyframes glowPulse {
  0%   { box-shadow: 0 0 0 rgba(0,0,0,0); }
  50%  { box-shadow: 0 0 40px rgba(108,242,194,.4); }
  100% { box-shadow: 0 0 0 rgba(0,0,0,0); }
}

/* ===== STATUS ===== */
.status {
  margin-top: 36px;              /* CLEAR SEPARATION */
  padding-top: 16px;
  border-top: 1px solid rgba(255,255,255,.08);
  text-align: center;
  font-size: clamp(1.1rem, 1.6vw, 1.3rem);
  color: var(--muted);
}
</style>

</head>

<body>

<div class="panel">
  <h1>ðŸ’¡ Presets</h1>

  <div class="grid" id="buttons"></div>

  <div class="status" id="status">Idle</div>
</div>

<script>
const buttonsDiv = document.getElementById("buttons");
const statusText = document.getElementById("status");
let activePreset = null;

async function api(path, body) {
  const res = await fetch(path, {
    method: "POST",
    headers: body ? { "Content-Type": "application/json" } : {},
    body: body ? JSON.stringify(body) : null
  });
  return res.json();
}

async function loadPresets() {
  const res = await fetch("/presets");
  const presets = await res.json();

  presets.forEach(preset => {
    const btn = document.createElement("button");
    btn.innerText = preset.replace(/_/g, " ");
    btn.onclick = () => togglePreset(preset);
    buttonsDiv.appendChild(btn);
  });

  syncStatus();
}

async function togglePreset(preset) {
  if (activePreset === preset) {
    await api("/stop");
    activePreset = null;
  } else {
    await api("/start", { preset });
    activePreset = preset;
  }
  updateUI();
}

async function syncStatus() {
  const res = await fetch("/status");
  const state = await res.json();
  activePreset = state.running ? state.preset : null;
  updateUI();
}

function updateUI() {
  document.querySelectorAll("button").forEach(b => {
    const name = b.innerText.replace(/ /g, "_");
    b.classList.toggle("active", name === activePreset);
  });

  statusText.innerText = activePreset
    ? `Running: ${activePreset}`
    : "Idle";
}

loadPresets();
</script>

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/sw.js");
}
</script>


</body>
</html>
